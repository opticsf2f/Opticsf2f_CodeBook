
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>4.2. Polarization in the circular basis: Poincare sphere &#8212; Optics f2f Code Book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. Many waves: Fresnel" href="Chapter5.html" />
    <link rel="prev" title="4.1. Polization standing waves" href="Pol_SW.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/Cover.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Optics f2f Code Book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    <a href="https://global.oup.com/academic/product/optics-f2f-9780198786795?cc=gb&lang=en&">Optics f2f</a> Code Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Chapter1.html">
   1. Introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Phasors.html">
     1.1. Phasors
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Chapter2.html">
   2. One wave
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="LensRefraction.html">
     2.1. Refraction: lens
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="PrismRefraction.html">
     2.2. Refraction: prism
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Disp.html">
     2.3. Dispersion: prism
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Chapter3.html">
   3. Two waves
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="StandingWave.html">
     3.1. Standing wave
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="PlaneWavesN.html">
     3.2. Plane wave interference
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="CurvedWaves.html">
     3.3. Curved waves interference
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Grating.html">
     3.4. Diffraction grating:
     <span class="math notranslate nohighlight">
      \(N\)
     </span>
     -slit interference
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="Chapter4.html">
   4. Polarization
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="Pol_SW.html">
     4.1. Polization standing waves
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     4.2. Polarization in the circular basis: Poincare sphere
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Chapter5.html">
   5. Many waves: Fresnel
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="FresnelSingleDoubleSlit.html">
     5.1. Single/Double slit diffraction using the Fresnel integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Talbot.html">
     5.2. Talbot carpet
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Chapter6.html">
   6. Many waves: Fourier
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="Letters.html">
     6.1. 2D FT of letters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DSlitExercise.html">
     6.2. 2D FT of two slits: Exercise
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ArrayRandom12.html">
     6.3. 2D FT of arrays: Exercise
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/opticsf2f/Opticsf2f_CodeBook/main?urlpath=tree/Pol_Poincare.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/opticsf2f/Opticsf2f_CodeBook"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/opticsf2f/Opticsf2f_CodeBook/issues/new?title=Issue%20on%20page%20%2FPol_Poincare.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/Pol_Poincare.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Polarization in the circular basis: Poincare sphere</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="polarization-in-the-circular-basis-poincare-sphere">
<h1><span class="section-number">4.2. </span>Polarization in the circular basis: Poincare sphere<a class="headerlink" href="#polarization-in-the-circular-basis-poincare-sphere" title="Permalink to this headline">#</a></h1>
<p>In this notebook we plot the spatial pattern traced out by the tip of the electric field vector for left and right circularly
polarized light, plus also a superposition of left and right. The relative amplitude and phase of this left/right superposition
is characterised by two angles, <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span>, which can be represented by a point on the <strong>Poincare sphere</strong>.</p>
<p>We shall plot the Poincare vector to the point <span class="math notranslate nohighlight">\((\theta,\phi)\)</span> in an inset.</p>
<p>There are many ways in python to make visualisations in 3D. Here we have used pyvista. <a class="reference external" href="https://docs.pyvista.org/">https://docs.pyvista.org/</a></p>
<p>As per usual the first cell imports all the packages we need.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pyvista</span> <span class="k">as</span> <span class="nn">pv</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>

<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.inset_locator</span> <span class="kn">import</span> <span class="n">inset_axes</span>
</pre></div>
</div>
</div>
</div>
<p>Now we define some functions to plot the electric fields. We use pyvista tube and arrow.</p>
<p>For left circular our <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> components are <span class="math notranslate nohighlight">\({\cal E}_0\cos(kz-\omega t)\)</span> and <span class="math notranslate nohighlight">\({\cal E}_0\sin(kz-\omega t)\)</span>, respectively.
For right circular we change the sign of the <span class="math notranslate nohighlight">\(y\)</span> component.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">left_tube</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">afreq</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <span class="n">num_pi</span><span class="o">=</span><span class="mi">32</span>
    <span class="n">zmax</span> <span class="o">=</span> <span class="n">num_pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">npts</span><span class="o">=</span><span class="mi">200</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>    
    <span class="n">E0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span>
    <span class="n">Ex</span> <span class="o">=</span>  <span class="n">E0</span><span class="o">*</span><span class="n">el</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">afreq</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="mi">0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">Ey</span> <span class="o">=</span>  <span class="n">E0</span><span class="o">*</span><span class="n">el</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">afreq</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="mi">0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">Ex</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">Ey</span><span class="p">))</span>
    <span class="n">spline</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Spline</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">spline</span><span class="p">[</span><span class="s2">&quot;scalars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">spline</span><span class="o">.</span><span class="n">n_points</span><span class="p">)</span>
    <span class="n">tube_data</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">tube</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tube_data</span>

<span class="k">def</span> <span class="nf">right_tube</span><span class="p">(</span><span class="n">er</span><span class="p">,</span><span class="n">afreq</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <span class="n">num_pi</span><span class="o">=</span><span class="mi">32</span>
    <span class="n">zmax</span> <span class="o">=</span> <span class="n">num_pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">npts</span><span class="o">=</span><span class="mi">200</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>    
    <span class="n">E0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span>
    <span class="n">Ex</span> <span class="o">=</span>  <span class="n">E0</span><span class="o">*</span><span class="n">er</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">afreq</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="mi">0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">Ey</span> <span class="o">=</span>  <span class="o">-</span><span class="n">E0</span><span class="o">*</span><span class="n">er</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">afreq</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="mi">0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">Ex</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">Ey</span><span class="p">))</span>
    <span class="n">spline</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Spline</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">spline</span><span class="p">[</span><span class="s2">&quot;scalars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">spline</span><span class="o">.</span><span class="n">n_points</span><span class="p">)</span>
    <span class="n">tube_data</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">tube</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tube_data</span>

<span class="k">def</span> <span class="nf">sum_tube</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">er</span><span class="p">,</span> <span class="n">afreq</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <span class="n">num_pi</span><span class="o">=</span><span class="mi">32</span>
    <span class="n">zmax</span> <span class="o">=</span> <span class="n">num_pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">npts</span><span class="o">=</span><span class="mi">200</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>    
    <span class="n">envelope</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">zmax</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">E0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span>
    <span class="n">Exl</span> <span class="o">=</span>  <span class="n">E0</span><span class="o">*</span><span class="n">el</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">afreq</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">t</span><span class="p">))</span>
    <span class="n">Eyl</span> <span class="o">=</span>  <span class="n">E0</span><span class="o">*</span><span class="n">el</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">afreq</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">t</span><span class="p">))</span>   
    <span class="n">Exr</span> <span class="o">=</span>  <span class="n">E0</span><span class="o">*</span><span class="n">er</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">afreq</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="mi">0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">Eyr</span> <span class="o">=</span>  <span class="o">-</span><span class="n">E0</span><span class="o">*</span><span class="n">er</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">afreq</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="mi">0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="o">+</span><span class="n">phi</span><span class="p">)</span>

    <span class="n">norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">el</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">er</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">Ex</span> <span class="o">=</span> <span class="p">(</span><span class="n">Exl</span> <span class="o">+</span> <span class="n">Exr</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span>
    <span class="n">Ey</span> <span class="o">=</span> <span class="p">(</span><span class="n">Eyl</span> <span class="o">+</span> <span class="n">Eyr</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">Ex</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">z</span> <span class="p">,</span> <span class="n">Ey</span><span class="p">))</span>
    <span class="n">spline</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Spline</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">spline</span><span class="p">[</span><span class="s2">&quot;scalars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">spline</span><span class="o">.</span><span class="n">n_points</span><span class="p">)</span>
    <span class="n">tube_data</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">tube</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tube_data</span>

<span class="k">def</span> <span class="nf">E_left_arrow</span><span class="p">(</span><span class="n">el</span><span class="p">,</span><span class="n">afreq</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <span class="n">num_pi</span><span class="o">=</span><span class="mi">32</span>
    <span class="n">zmax</span> <span class="o">=</span> <span class="n">num_pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">E_arrow_size</span><span class="o">=</span><span class="mi">50</span><span class="o">*</span><span class="n">el</span>
    <span class="n">E_arrow_data</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Arrow</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">direction</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">afreq</span><span class="o">*</span><span class="n">t</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">afreq</span><span class="o">*</span><span class="n">t</span><span class="p">)]),</span><span class="c1"># * self.r,</span>
                       <span class="n">tip_length</span><span class="o">=</span><span class="mi">20</span><span class="o">/</span><span class="n">E_arrow_size</span><span class="p">,</span> <span class="n">tip_radius</span><span class="o">=</span><span class="mi">4</span><span class="o">/</span><span class="n">E_arrow_size</span><span class="p">,</span> <span class="n">tip_resolution</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                       <span class="n">shaft_radius</span><span class="o">=</span><span class="mi">2</span><span class="o">/</span><span class="n">E_arrow_size</span><span class="p">,</span> <span class="n">shaft_resolution</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">E_arrow_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">E_arrow_data</span>

<span class="k">def</span> <span class="nf">E_right_arrow</span><span class="p">(</span><span class="n">er</span><span class="p">,</span><span class="n">afreq</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <span class="n">num_pi</span><span class="o">=</span><span class="mi">32</span>
    <span class="n">zmax</span> <span class="o">=</span> <span class="n">num_pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">E_arrow_size</span><span class="o">=</span><span class="mi">50</span><span class="o">*</span><span class="n">er</span>
    <span class="n">E_arrow_data</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Arrow</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">direction</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">afreq</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">phi</span><span class="o">+</span><span class="mi">0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="o">-</span><span class="n">afreq</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">phi</span><span class="o">+</span><span class="mi">0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)]),</span><span class="c1"># * self.r,</span>
                       <span class="n">tip_length</span><span class="o">=</span><span class="mi">20</span><span class="o">/</span><span class="n">E_arrow_size</span><span class="p">,</span> <span class="n">tip_radius</span><span class="o">=</span><span class="mi">4</span><span class="o">/</span><span class="n">E_arrow_size</span><span class="p">,</span> <span class="n">tip_resolution</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                       <span class="n">shaft_radius</span><span class="o">=</span><span class="mi">2</span><span class="o">/</span><span class="n">E_arrow_size</span><span class="p">,</span> <span class="n">shaft_resolution</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">E_arrow_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">E_arrow_data</span>
</pre></div>
</div>
</div>
</div>
<p>These two functions create all the data for the polarization plot and the Poincare sphere.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">PNG_data</span><span class="p">(</span><span class="n">Theta</span><span class="p">,</span><span class="n">Phi</span><span class="p">):</span>
    <span class="c1">#    p=pv.Plotter(shape=(1, 1),multi_samples=1,window_size=(800,800),off_screen=True,notebook=False)</span>
    <span class="n">afreq</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">relative_phase</span> <span class="o">=</span> <span class="n">Phi</span> <span class="o">-</span> <span class="mi">0</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>

    <span class="n">el</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Theta</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">er</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Theta</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">left_tube</span><span class="p">(</span><span class="n">el</span><span class="p">,</span><span class="n">afreq</span><span class="p">,</span> <span class="n">relative_phase</span><span class="p">),</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">show_scalar_bar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">right_tube</span><span class="p">(</span><span class="n">er</span><span class="p">,</span><span class="n">afreq</span><span class="p">,</span> <span class="n">relative_phase</span><span class="p">),</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">show_scalar_bar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">sum_tube</span><span class="p">(</span><span class="n">el</span><span class="p">,</span><span class="n">er</span><span class="p">,</span><span class="n">afreq</span><span class="p">,</span> <span class="n">relative_phase</span><span class="p">),</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">show_scalar_bar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">z_arrow_size</span><span class="o">=</span><span class="mi">175</span>
    <span class="n">z_arrow</span><span class="o">=</span><span class="n">pv</span><span class="o">.</span><span class="n">Arrow</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">direction</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span><span class="c1"># * self.r,</span>
                           <span class="n">tip_length</span><span class="o">=</span><span class="mi">10</span><span class="o">/</span><span class="n">z_arrow_size</span><span class="p">,</span> <span class="n">tip_radius</span><span class="o">=</span><span class="mi">2</span><span class="o">/</span><span class="n">z_arrow_size</span><span class="p">,</span> <span class="n">tip_resolution</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
                           <span class="n">shaft_radius</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">z_arrow_size</span><span class="p">,</span> <span class="n">shaft_resolution</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">z_arrow_size</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">z_arrow</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">x_arrow_size</span><span class="o">=</span> <span class="mi">100</span>
    <span class="n">x_arrow</span><span class="o">=</span><span class="n">pv</span><span class="o">.</span><span class="n">Arrow</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">direction</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span><span class="c1"># * self.r,</span>
                           <span class="n">tip_length</span><span class="o">=</span><span class="mi">10</span><span class="o">/</span><span class="n">x_arrow_size</span><span class="p">,</span> <span class="n">tip_radius</span><span class="o">=</span><span class="mi">2</span><span class="o">/</span><span class="n">x_arrow_size</span><span class="p">,</span> <span class="n">tip_resolution</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
                           <span class="n">shaft_radius</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">x_arrow_size</span><span class="p">,</span> <span class="n">shaft_resolution</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">x_arrow_size</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">x_arrow</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">y_arrow_size</span><span class="o">=</span> <span class="mi">100</span>
    <span class="n">y_arrow</span><span class="o">=</span><span class="n">pv</span><span class="o">.</span><span class="n">Arrow</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">direction</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="c1"># * self.r,</span>
                           <span class="n">tip_length</span><span class="o">=</span><span class="mi">10</span><span class="o">/</span><span class="n">y_arrow_size</span><span class="p">,</span> <span class="n">tip_radius</span><span class="o">=</span><span class="mi">2</span><span class="o">/</span><span class="n">y_arrow_size</span><span class="p">,</span> <span class="n">tip_resolution</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
                           <span class="n">shaft_radius</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">y_arrow_size</span><span class="p">,</span> <span class="n">shaft_resolution</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">y_arrow_size</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">y_arrow</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">E_left_arrow</span><span class="p">(</span><span class="n">el</span><span class="p">,</span><span class="n">afreq</span><span class="p">,</span> <span class="n">relative_phase</span><span class="p">),</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">E_right_arrow</span><span class="p">(</span><span class="n">er</span><span class="p">,</span><span class="n">afreq</span><span class="p">,</span> <span class="n">relative_phase</span><span class="p">),</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#    p.enable_depth_peeling(10)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">420</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">40</span><span class="p">),(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">),(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)]</span> 
    <span class="n">p</span><span class="o">.</span><span class="n">set_background</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">png_output</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>    
    <span class="k">return</span> <span class="n">png_output</span>

<span class="k">def</span> <span class="nf">BS_data</span><span class="p">(</span><span class="n">Theta</span><span class="p">,</span><span class="n">Phi</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
    
    <span class="n">num</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">60</span>

    <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">rpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
    <span class="n">spline</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Spline</span><span class="p">(</span><span class="n">rpts</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">rxy_tube</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">tube</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">rpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
    <span class="n">spline</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Spline</span><span class="p">(</span><span class="n">rpts</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">rxz_tube</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">tube</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
    <span class="n">rpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
    <span class="n">spline</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Spline</span><span class="p">(</span><span class="n">rpts</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">ryz_tube</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">tube</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>

    <span class="c1"># add sphere</span>
    <span class="n">big</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">radius</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">big</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">specular</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># add cross-sections</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">rxy_tube</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cDUkk</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">rxz_tube</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cDUkk</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">ryz_tube</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cDUkk</span><span class="p">)</span>
    
    <span class="n">p</span><span class="o">.</span><span class="n">set_background</span><span class="p">(</span><span class="n">cDUsky</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">14</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">),</span>
                            <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                            <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
    
    <span class="n">addAxisArrow</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">cDUo</span><span class="p">)</span>
    <span class="n">addAxisArrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">cDUy</span><span class="p">)</span>
    <span class="n">addAxisArrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">cDUb</span><span class="p">)</span>
    <span class="n">addStateArrow</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
    <span class="n">png_output</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">png_output</span>

<span class="k">def</span> <span class="nf">addAxisArrow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">color</span><span class="p">):</span>
    <span class="n">r</span><span class="o">=</span><span class="mi">3</span>
    <span class="n">length</span> <span class="o">=</span> <span class="mf">1.25</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
    <span class="n">arrow</span><span class="o">=</span><span class="n">pv</span><span class="o">.</span><span class="n">Arrow</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">direction</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])</span> <span class="o">*</span> <span class="n">r</span><span class="p">,</span>
                   <span class="n">tip_length</span><span class="o">=</span><span class="mf">0.15</span><span class="o">/</span><span class="n">length</span><span class="p">,</span> <span class="n">tip_radius</span><span class="o">=</span><span class="mf">0.05</span><span class="o">/</span><span class="n">length</span><span class="p">,</span> <span class="n">tip_resolution</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                   <span class="n">shaft_radius</span><span class="o">=</span><span class="mf">0.025</span><span class="o">/</span><span class="n">length</span><span class="p">,</span> <span class="n">shaft_resolution</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">length</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">arrow</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">addStateArrow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">):</span>
    <span class="n">r</span><span class="o">=</span><span class="mi">3</span>
    <span class="n">length</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
    <span class="n">arrow</span><span class="o">=</span><span class="n">pv</span><span class="o">.</span><span class="n">Arrow</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">direction</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])</span> <span class="o">*</span> <span class="n">r</span><span class="p">,</span>
                   <span class="n">tip_length</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">tip_radius</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">tip_resolution</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                   <span class="n">shaft_radius</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">shaft_resolution</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">length</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">arrow</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Green&#39;</span><span class="p">,</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We define some colours to use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#: Durham colour scheme</span>
<span class="n">cDUp</span> <span class="o">=</span> <span class="s2">&quot;#7E317B&quot;</span>  <span class="c1"># Palatinate Purple</span>
<span class="n">cDUpp</span> <span class="o">=</span>  <span class="s2">&quot;#D8ACF4&quot;</span>  <span class="c1"># Light purple</span>

<span class="n">cDUb</span> <span class="o">=</span> <span class="s2">&quot;#006388&quot;</span>  <span class="c1"># Blue</span>
<span class="n">cDUbb</span> <span class="o">=</span> <span class="s2">&quot;#91B8BD&quot;</span>  <span class="c1"># Mid Blue</span>
<span class="n">cDUbbb</span> <span class="o">=</span> <span class="s2">&quot;#C4E5FA&quot;</span>  <span class="c1"># Light Blue</span>
<span class="n">cDUbbbb</span> <span class="o">=</span> <span class="s2">&quot;#00AEEF&quot;</span>

<span class="n">cDUsky</span> <span class="o">=</span> <span class="s2">&quot;#A5C8D0&quot;</span>  <span class="c1"># sky blue</span>

<span class="n">cDUo</span> <span class="o">=</span> <span class="s2">&quot;#9FA161&quot;</span>  <span class="c1"># Olive Green</span>

<span class="n">cDUr</span> <span class="o">=</span> <span class="s2">&quot;#AA2B4A&quot;</span>  <span class="c1"># Red</span>
<span class="n">cDUrr</span> <span class="o">=</span> <span class="s2">&quot;#BE1E2D&quot;</span>
<span class="n">cDUy</span> <span class="o">=</span> <span class="s2">&quot;#E8E391&quot;</span> <span class="c1">#  Yellow</span>

<span class="n">cDUp</span> <span class="o">=</span> <span class="s2">&quot;#C43B8E&quot;</span> <span class="c1"># Pink</span>

<span class="n">cDUk</span> <span class="o">=</span> <span class="s2">&quot;#231F20&quot;</span>  <span class="c1"># Black</span>
<span class="n">cDUkk</span> <span class="o">=</span> <span class="s2">&quot;#002A41&quot;</span> <span class="c1"># ink</span>

<span class="n">cDUggg</span> <span class="o">=</span> <span class="s2">&quot;#CFDAD1&quot;</span>  <span class="c1"># Near White/L. Grey</span>
<span class="n">cDUgg</span> <span class="o">=</span> <span class="s2">&quot;#968E85&quot;</span>  <span class="c1"># Warm Grey</span>
<span class="n">cDUg</span> <span class="o">=</span> <span class="s2">&quot;#6E6464&quot;</span>  <span class="c1"># midgrey</span>
</pre></div>
</div>
</div>
</div>
<p>Finally we make a plot. The key input parameters are Theta and Phi. You should check that left (blue)
and right (red) have the correct
handedness, and play around with different values of Theta and Phi to generate interesting superpositions.
What values are needed to create linearly polarized light aligned on the <span class="math notranslate nohighlight">\(+45\)</span> degree axis?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-8</span>

<span class="n">Theta</span> <span class="o">=</span> <span class="mf">3.</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span> <span class="o">+</span> <span class="n">eps</span>
<span class="n">Phi</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">p</span><span class="o">=</span><span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span><span class="n">multi_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">window_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1600</span><span class="p">,</span><span class="mi">1600</span><span class="p">),</span><span class="n">off_screen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">notebook</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">png_output1</span> <span class="o">=</span> <span class="n">PNG_data</span><span class="p">(</span><span class="n">Theta</span><span class="p">,</span><span class="n">Phi</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">screenshot</span><span class="o">=</span><span class="n">png_output1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">470</span><span class="p">,</span><span class="mi">440</span><span class="p">,</span><span class="s1">&#39;$y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">24</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1380</span><span class="p">,</span><span class="mi">960</span><span class="p">,</span><span class="s1">&#39;$z$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">24</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">275</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="s1">&#39;$(i)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">24</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">ax1ins</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;50%&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;75%&quot;</span><span class="p">,</span>
                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">.525</span><span class="p">,</span> <span class="mf">.485</span><span class="p">,</span> <span class="mf">.725</span><span class="p">,</span> <span class="mf">.725</span><span class="p">),</span>
                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">p</span><span class="o">=</span><span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span><span class="n">multi_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">window_size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span><span class="mi">600</span><span class="p">),</span><span class="n">off_screen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">notebook</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">num</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Theta</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
<span class="n">rpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
<span class="n">spline</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Spline</span><span class="p">(</span><span class="n">rpts</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">theta_tube</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">tube</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">theta_tube</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cDUb</span><span class="p">)</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">Theta</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
<span class="n">rpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
<span class="n">spline</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Spline</span><span class="p">(</span><span class="n">rpts</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">theta_tube</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">tube</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">theta_tube</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cDUk</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
<span class="n">rpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
<span class="n">spline</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Spline</span><span class="p">(</span><span class="n">rpts</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">theta_tube</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">tube</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">theta_tube</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cDUk</span><span class="p">)</span>


<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Phi</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
<span class="n">z</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="n">rpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
<span class="n">spline</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Spline</span><span class="p">(</span><span class="n">rpts</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">phi_tube</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">tube</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">phi_tube</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">smooth_shading</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cDUo</span><span class="p">)</span>

<span class="n">png_output2</span> <span class="o">=</span> <span class="n">BS_data</span><span class="p">(</span><span class="n">Theta</span><span class="p">,</span><span class="n">Phi</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">screenshot</span><span class="o">=</span><span class="n">png_output2</span><span class="p">)</span>

<span class="n">ax1ins</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
<span class="c1">#ax1ins.text(500,400,&#39;$y$&#39;, fontsize = 32)</span>
<span class="c1">#ax1ins.text(1400,960,&#39;$z$&#39;, fontsize = 32)</span>
<span class="c1">#ax1ins.text(100,400,&#39;$(ii)$&#39;, fontsize = 32)</span>
<span class="n">ax1ins</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Pol_Poincare_9_0.png" src="_images/Pol_Poincare_9_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;Pol_Poincare_test.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Pol_SW.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">4.1. </span>Polization standing waves</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Chapter5.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Many waves: Fresnel</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By C. S. Adams and I. G. Hughes<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>